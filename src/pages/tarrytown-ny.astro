---
import CateringCTA from "../components/CateringCTA.astro";
import BaseLayout from "../layouts/BaseLayout.astro";
import { supabase } from "../lib/supabase";
import "@splidejs/splide/css";

// Define the interface for reviews from Supabase
interface Review {
    id: number;
    quote: string;
    name: string;
    location: string;
    type: string;
    display: boolean;
}

// Fetch reviews from Supabase
let testimonials: { quote: string; author: string }[] = [];

try {
    const { data, error } = await supabase
        .from("reviews")
        .select("quote, name")
        .eq("location", "Tarrytown")
        .eq("type", "Restaurant")
        .eq("display", true);

    if (error) {
        console.error("Error fetching reviews:", error);
    } else if (data && data.length > 0) {
        // Shuffle and pick 4 random reviews
        const shuffled = data.sort(() => Math.random() - 0.5);
        testimonials = shuffled.slice(0, 4).map((review) => ({
            quote: review.quote,
            author: review.name,
        }));
    }
} catch (e) {
    console.error("Unexpected error fetching reviews:", e);
}
---

<BaseLayout title="Best Tacos in Tarrytown | Mexican Restaurant | Lunch & Dinner" description="Join us on Main Street for the best tacos in Tarrytown, NY. Open for lunch and dinner every day! Stop by or order online.">





    <!-- Banner Section -->
    <section class="bg-crema relative flex min-h-[55vh]">
        <div class="w-[50vw] bg-[url('/tarrytown_banner.jpg')] bg-cover bg-center"></div>

        <!-- Right Column: Text Content -->
        <div class="flex flex-col">
            <div class="py-9 px-12 w-full md:max-w-[calc(var(--max-content-width)*0.5)] h-full flex flex-col justify-between gap-12 md:gap-24">
                <h1 class="font-futura text-ink text-[56px] md:text-[96px] leading-[0.88] uppercase tracking-tight">
                    Tarrytown,<br />New York
                </h1>
                <div class="flex flex-col gap-9">
                    <div class="flex flex-col gap-3.5">
                        <p class="font-geist text-ink text-sm text-3.5 leading-[1.4]">18 Main St. Tarrytown, NY 10591</p>
                        <p class="font-geist text-ink text-sm leading-[1.4]">
                            11am-9pm Sunday-Thursday<br />
                            11am-10pm Friday &amp; Saturday
                        </p>
                        <div class="flex items-center gap-2">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g class="oi-phone">
                                    <path class="oi-box" d="M16 2.5H8C6.89543 2.5 6 3.39543 6 4.5V19.5C6 20.6046 6.89543 21.5 8 21.5H16C17.1046 21.5 18 20.6046 18 19.5V4.5C18 3.39543 17.1046 2.5 16 2.5Z" stroke="var(--color-hot-sauce)" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"></path>
                                    <path class="oi-mini-dot" d="M12 18H12.012" stroke="var(--color-hot-sauce)" stroke-width="2.00" stroke-linecap="round"></path>
                                </g>
                            </svg>
                            <a href="tel:+19149094455" class="font-geist text-hot-sauce text-sm leading-[1.4]">(914) 909-4455</a>
                        </div>
                        <div class="flex items-center gap-2">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g class="oi-email">
                                    <path class="oi-box" d="M3 6C3 5.44772 3.44772 5 4 5H20C20.5523 5 21 5.44772 21 6V18C21 18.5523 20.5523 19 20 19H4C3.44772 19 3 18.5523 3 18V6Z" stroke="var(--color-hot-sauce)" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"></path>
                                    <path class="oi-vector" d="M4 6L12 13L20 6" stroke="var(--color-hot-sauce)" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"></path>
                                </g>
                            </svg>
                            <a href="mailto:tarrytown@thetacoproject.com" class="font-geist text-hot-sauce text-sm leading-[1.4]">tarrytown@thetacoproject.com</a>
                        </div>
                    </div>
                    <div class="flex items-center gap-8">
                        <a href="https://order.toasttab.com/online/the-taco-project-tarrytown-18-main-street" rel="noopener nofollow noreferrer" target="_blank" class="btn btn-primary inline-flex items-center gap-2 bg-hot-sauce text-crema font-geist text-sm uppercase px-6 py-3 hover:opacity-90 transition-opacity w-fit">
                            Order online
                            <svg class="w-4 h-4" aria-hidden="true" focusable="false">
                                <use href="#icon-external-link"></use>
                            </svg>
                        </a>
                        <a href="https://www.toasttab.com/catering/the-taco-project-tarrytown-18-main-street" rel="noopener nofollow noreferrer" target="_blank" class="font-geist text-hot-sauce">
                            <div class="flex items-center gap-2 text-hot-sauce font-geist text-sm uppercase transition-all duration-500 hover:text-ink group-focus:text-ink">
                                Order Catering
                                <svg class="w-4 h-4" aria-hidden="true" focusable="false">
                                    <use href="#icon-external-link"></use>
                                </svg>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>


    <!-- location details -->
    <section id="store_details" class="bg-tortilla pt-16">
        <div class="px-6">
            <div class="flex flex-col gap-9 max-w-lg">
                <p class="font-geist text-ink text-sm leading-[1.4]">At The Taco Project in Tarrytown, we're committed to providing our customers with an authentic and memorable dining experience. That's why we pride ourselves on our friendly service, cozy atmosphere, and vibrant flavors. From our colorful decor to our festive music, we're dedicated to bringing the energy and excitement of Mexico to every meal.</p>
            </div>
        </div>

        <div class="px-6 md:px-8 lg:px-12 overflow-x-auto py-12">
            <!-- Photo Layout -->
            <div class="flex gap-4 w-max items-end">
                <img src="/tarrytown-taco-project-2.jpg" alt="Tarrytown Taco Project Interior" class="w-[57vw] md:w-[40vw] lg:w-[28vw]" loading="lazy" decoding="async" />
                <img src="/the-taco-project-menu-items.webp" alt="Menu Items from The Taco Project" class="w-[57vw] md:w-[40vw] lg:w-[28vw]" loading="lazy" decoding="async" />
                <img src="/tarrytown-taco-project-4.jpg" alt="Food at The Taco Project" class="w-[57vw] md:w-[40vw] lg:w-[28vw]" loading="lazy" decoding="async" />
                <img src="/friends-eating-at-the-taco-project.webp" alt="Friends Eating at The Taco Project" class="w-[57vw] md:w-[40vw] lg:w-[28vw]" loading="lazy" decoding="async" />
                <img src="/delicious-food-at-the-taco-project.webp" alt="Delicious Food at The Taco Project" class="w-[57vw] md:w-[40vw] lg:w-[28vw]" loading="lazy" decoding="async" />
            </div>
        </div>
    </section>

    <CateringCTA />


    <!-- Testimonial Slider -->
    <section class="bg-hot-sauce py-24 px-5">
        <div class="max-w-3xl mx-auto">
            <div class="splide" aria-label="Customer Testimonials">
                <div class="splide__track">
                    <ul class="splide__list">
                        {
                            testimonials.map((t) => (
                                <li class="splide__slide">
                                    <div class="flex flex-col items-start gap-6 select-none cursor-grab active:cursor-grabbing">
                                        <div class="flex gap-1">
                                            {/* 5 Stars */}
                                            {[...Array(5)].map(() => (
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-5 text-crema">
                                                    <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
                                                </svg>
                                            ))}
                                        </div>
                                        <p class="font-geist text-crema leading-snug font-normal text-pretty">{t.quote}</p>
                                        <p class="font-geist text-crema leading-snug text-sm font-normal">â€” {t.author}</p>
                                    </div>
                                </li>
                            ))
                        }
                    </ul>
                </div>

                <!-- Custom Arrows -->
                <div class="splide__arrows flex gap-4 mt-8">
                    <button class="splide__arrow splide__arrow--prev !static !transform-none !opacity-100 !w-auto !h-auto !bg-transparent group cursor-pointer" type="button" aria-label="Previous slide">
                        <div class="w-12 h-12 rounded-full bg-crema flex items-center justify-center transition-colors hover:opacity-80 text-ink">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 13 13" class="size-5">
                                <use href="#icon-arrow-right"></use>
                            </svg>
                        </div>
                    </button>
                    <button class="splide__arrow splide__arrow--next !static !transform-none !opacity-100 !w-auto !h-auto !bg-transparent group cursor-pointer" type="button" aria-label="Next slide">
                        <div class="w-12 h-12 rounded-full bg-crema flex items-center justify-center transition-colors hover:opacity-80 text-ink">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 13 13" class="size-5">
                                <use href="#icon-arrow-right"></use>
                            </svg>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <script>
        import Splide from "@splidejs/splide";

        document.addEventListener("DOMContentLoaded", () => {
            new Splide(".splide", {
                type: "loop",
                perPage: 1,
                arrows: true,
                pagination: false, // Disabled pagination
                autoplay: false,
            }).mount();
        });

        document.querySelectorAll(".faq-toggle").forEach((button) => {
            button.addEventListener("click", () => {
                const isExpanded = button.getAttribute("aria-expanded") === "true";
                button.setAttribute("aria-expanded", (!isExpanded).toString());

                const answerId = button.getAttribute("aria-controls");
                if (answerId) {
                    const answer = document.getElementById(answerId);
                    if (answer) {
                        answer.classList.toggle("hidden");
                    }
                }
            });
        });
    </script>

</BaseLayout>
